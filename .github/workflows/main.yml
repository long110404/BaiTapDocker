name: CI/CD Build Test

on:
  push:
    branches: [ "main" ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    
    steps:
    - name: 1. Tai code ve may ao
      uses: actions/checkout@v3
    
    - name: 2. Kiem tra thu muc
      run: ls -la
      
    - name: 3. Test Build Project 1 (PHP)
      run: |
        if [ -d "Docker-PHP" ]; then
          echo "Building PHP Project..."
          cd Docker-PHP
          # Chay thu lenh build nhung khong can chay han len
          docker build .
        else
          echo "LOI: Khong thay thu muc Docker-PHP"
          exit 1
        fi

    - name: 4. Test Build Project 2 (.NET)
      run: |
        cd ..
        if [ -d "Docker-DotNet" ]; then
          echo "Building .NET Project..."
          cd Docker-DotNet
          # Test build don gian
          docker compose config
        else
          echo "LOI: Khong thay thu muc Docker-DotNet"
          exit 1
        fi
        
    - name: 5. Ket qua
      run: echo "DA BUILD & TEST THANH CONG! Code ngon lanh."
